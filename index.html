<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Planner</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@300;400;700&display=swap');

    :root {
      --pink-bg: #ffe4ef;
      --pink-card: #ffd1e3;
      --pink-accent: #ff7aa2;
      --today-accent: #b65cff;
      --text: #333;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Merriweather', serif;
      background: var(--pink-bg);
      color: var(--text);
    }

    header {
      padding: 1rem;
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    header input {
      padding: 0.4rem 0.6rem;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    .planner {
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      overflow-x: auto; /* optional: scroll instead of breaking */
    }

    .week {
      display: grid;
      grid-template-columns: repeat(7, calc((100% - 6*0.6rem)/7)); /* 7 columns, 6 gaps subtracted */
      gap: 0.6rem;
      background: var(--pink-card);
      border-radius: 14px;
      padding: 0.75rem;
    }

    .week {
      width: 100%;
      max-width: 100%;
    }

    .week-label {
      text-align: center;
      font-weight: 700;
      color: #8a3d5c;
    }

    .day {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
      background: rgba(255,255,255,0.7);
      border-radius: 10px;
      padding: 0.4rem;
    }

    .day-header {
      text-align: center;
      font-weight: 700;
      font-size: 0.85rem;
      border-radius: 6px;
      padding: 0.25rem;
    }

    .day-header.today {
      background: var(--today-accent);
      color: white;
    }

    .progress {
      height: 6px;
      background: #f5b6cc;
      border-radius: 6px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: var(--pink-accent);
      width: 0%;
    }

    .percent {
      font-size: 0.7rem;
      text-align: center;
    }

    .task {
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .task input[type="text"] {
      flex: 1;
      border: none;
      background: transparent;
      outline: none;
      font-size: 0.7rem;
    }

    .task.completed input[type="text"] {
      text-decoration: line-through;
      opacity: 0.6;
    }

    .delete {
      border: none;
      background: none;
      cursor: pointer;
      font-size: 0.75rem;
    }
  </style>
</head>
<body>
  <header>
    <strong>Start date:</strong>
    <input type="date" id="startDate" />
  </header>

  <main class="planner">
    <div id="weeks"></div>
  </main>

  <script>
    const startDateInput = document.getElementById('startDate');
    const weeksEl = document.getElementById('weeks');

    const STORAGE_KEY = 'threeWeekPlannerData';
    const data = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');

    const today = new Date();
    today.setHours(0,0,0,0);
    startDateInput.valueAsDate = today;

    const weekdayNames = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

    function dateKey(d) {
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2,'0');
      const da = String(d.getDate()).padStart(2,'0');
      return `${y}-${m}-${da}`;
    }

    function save() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    function render() {
      weeksEl.innerHTML = '';

      const [yy, mm, dd] = startDateInput.value.split('-').map(Number);
      const start = new Date(yy, mm - 1, dd);
      start.setHours(0,0,0,0);

      for (let w = 0; w < 3; w++) {
        const week = document.createElement('div');
        week.className = 'week';

        // Add weekday labels (first row in grid)
        for (let d = 0; d < 7; d++) {
          const label = document.createElement('div');
          label.className = 'week-label';
          const date = new Date(start);
          date.setDate(start.getDate() + w*7 + d);
          label.textContent = weekdayNames[date.getDay()];
          week.appendChild(label);
        }

        // Add day boxes (second row in grid)
        for (let d = 0; d < 7; d++) {
          const date = new Date(start);
          date.setDate(start.getDate() + w*7 + d);
          const k = dateKey(date);

          if (!data[k]) data[k] = Array.from({length:8},()=>({text:'',done:false}));

          const tasks = data[k];
          const done = tasks.filter(t=>t.done && t.text.trim()).length;
          const total = tasks.filter(t=>t.text.trim()).length || 1;
          const pct = Math.round((done/total)*100);

          const day = document.createElement('div');
          day.className = 'day';

          const header = document.createElement('div');
          header.className = 'day-header';
          if(date.getTime() === today.getTime()) header.classList.add('today');
          header.textContent = `${date.getMonth()+1}/${date.getDate()}`;

          const progress = document.createElement('div');
          progress.className = 'progress';
          const bar = document.createElement('div');
          bar.className = 'progress-bar';
          bar.style.width = pct + '%';
          progress.appendChild(bar);

          const percent = document.createElement('div');
          percent.className = 'percent';
          percent.textContent = pct + '%';

          day.append(header, progress, percent);

          tasks.forEach((task,i)=>{
            const row = document.createElement('div');
            row.className = 'task';
            if(task.done) row.classList.add('completed');

            const cb = document.createElement('input');
            cb.type='checkbox';
            cb.checked=task.done;
            cb.onchange=()=>{task.done=cb.checked; save(); render();};

            const input = document.createElement('input');
            input.type='text';
            input.value=task.text;
            input.placeholder='Task';
            input.oninput=()=>{task.text=input.value; save();};

            const del=document.createElement('button');
            del.className='delete';
            del.textContent='âœ•';
            del.onclick=()=>{tasks[i]={text:'',done:false}; save(); render();};

            row.append(cb,input,del);
            day.appendChild(row);
          });

          week.appendChild(day);
        }

        weeksEl.appendChild(week);
      }

      save();
    }

    startDateInput.addEventListener('change', render);
    render();
  </script>
</body>
</html>


